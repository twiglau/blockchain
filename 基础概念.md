###### 共识机制

1. POW 工作量证明
2. POS 权益证明: 谁占股份多,谁说了算
3. DPOS 代理权益说明: 向所有人证明权益太难,选出代表开会,定期竞选代表

###### 非对称加密

蜗牛 ==== 你今天做什么了 ===> 小明

1. 对称加密: 私钥 - AES

   蜗牛 私钥加密 (你今天做什么了) ==== (密文) ====> 私钥解密(密文)

2. 非对称加密: 公私钥 RSA 非对称加密

   蜗牛: 信息 + 私钥加密信息(你今天做什么了) + 公钥

   小明: 信息 + 加密后的签名 + 公钥 通过公钥验证信息是否合法

   特点: 公钥可以根据私钥计算得来,不可逆, 私钥就是一个随机字符串

###### 容错

xxxxxx

###### 分布式

1. xxxxxx

地址和区块

DAPP,智能合约

###### 传统记账

1. 村长负责记账
2. 谁收入多少
3. 谁给谁转账

###### 区块链记账

1. 每人都有记账权利
2. 每个交易都会全网广播,一起记录
3. 账本没一页是一个区块
4. 区块上有一个数, 指向前一个区块
5. 什么时候同步: 挖矿(竞争获得记账权)

###### 加密/签名

私钥加密 (小明 小红 100 块钱) sig
小明 小红 100 块钱 sig (交易信息加了一个签名)

地址就是公钥 可以交易 sig

矿工打包的时候, 会进行每个交易的合法校验

1. sig 是签名校验合法
2. 账号的余额够不够

###### P2P

1. 点对点: P 迅雷 电驴 下载小电影 解决带宽问题
2. 启动节点
3. 完全去中心化 DHT 的 Kademlia 网络

服务器 都从这里获取

peer to peer

朋友圈 种子(公网 IP)

1. 小明 和 小红 对话
   小明发送: 你好,我是小明 --> 到 种子 这里
   种子为: 小明分配: 网件(IP) + Port(3000),并且将 小明 信息 存入 种子 这里
2. 如果该 种子 服务器 挂掉了,但还有其他的 种子 服务器可用,那么并不会影响 小明和小红的交流.
   小明和小红的交流并不会占用 种子 服务器的带宽

###### UDP 协议

- 只管发,不管你有没有收到
- `dgram` 自带模块来处理 UDP

###### 简单 udp 打洞实现 p2p

1. 一个特殊的种子节点
   每个节点保存全部的节点 IP 和端口
2. 新节点 => 加入 种子节点: 我来啦, 我的 IP 是 xx , 端口是 yy
3. 但是新节点不在别人网件白名单里, 没法直接通信
4. 全体 SayHi, 只为加上白名单

- 新节点给所有已知节点发消息,新节点的网件上把所有节点加上-白名单
- 已知节点给新节点发消息,同理加白名单
- UDP 不可靠,很粗暴的挖矿和交易都加一个全局广播的逻辑

###### 将 P2P 放入链中

1. 本地模拟种子节点

###### Linux 中查看端口是否已监听

```sh
lsof -i:8001
```

##### 广播

1. 新节点加入, 同步种子节点的区块链信息
2. 挖矿广播
3. 交易广播
